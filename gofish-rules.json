{
  "gameInfo": {
    "name": "Go Fish",
    "version": "1.0.0",
    "description": "A classic card matching game where players collect sets of four cards of the same rank."
  },
  "zones": [
    {
      "id": "deck",
      "displayName": "Deck",
      "visibility": "hidden",
      "owner": "shared",
      "ordered": true,
      "maxCards": null
    },
    {
      "id": "hand",
      "displayName": "Hand",
      "visibility": "owner",
      "owner": "player",
      "ordered": false,
      "maxCards": null
    },
    {
      "id": "sets",
      "displayName": "Completed Sets",
      "visibility": "public",
      "owner": "player",
      "ordered": false,
      "maxCards": null
    }
  ],
  "cardProperties": [
    {
      "id": "rank",
      "displayName": "Rank",
      "type": "string",
      "defaultValue": null
    },
    {
      "id": "suit",
      "displayName": "Suit",
      "type": "string",
      "defaultValue": null
    },
    {
      "id": "setId",
      "displayName": "Set ID",
      "type": "string",
      "defaultValue": null
    }
  ],
  "resources": [
    {
      "id": "score",
      "displayName": "Score",
      "startingValue": 0,
      "minimum": 0,
      "maximum": null,
      "resetsEachTurn": false
    }
  ],
  "turnStructure": {
    "initialPlayer": "random",
    "playOrder": "clockwise",
    "phases": [
      {
        "id": "start",
        "displayName": "Start of Turn",
        "automaticActions": [
          {
            "type": "checkEmptyHand",
            "effects": [
              {
                "type": "drawCards",
                "parameters": {
                  "condition": {
                    "type": "emptyHand",
                    "parameters": {}
                  },
                  "count": 1,
                  "from": "deck",
                  "to": "hand"
                }
              }
            ]
          }
        ],
        "allowedActions": [],
        "skippable": true,
        "eachPlayer": false
      },
      {
        "id": "askCard",
        "displayName": "Ask for Card",
        "allowedActions": [
          {
            "type": "askForCard",
            "displayName": "Ask Player for Card",
            "conditions": [
              {
                "type": "hasCard",
                "parameters": {
                  "zone": "hand"
                }
              }
            ],
            "effects": [
              {
                "type": "revealRank",
                "parameters": {
                  "rank": {
                    "reference": "action.rank"
                  }
                }
              },
              {
                "type": "conditional",
                "parameters": {
                  "condition": {
                    "type": "opponentHasRank",
                    "parameters": {
                      "rank": {
                        "reference": "action.rank"
                      },
                      "playerIndex": {
                        "reference": "action.targetPlayer"
                      }
                    }
                  },
                  "ifTrue": [
                    {
                      "type": "transferCards",
                      "parameters": {
                        "fromPlayer": {
                          "reference": "action.targetPlayer"
                        },
                        "toPlayer": {
                          "reference": "action.playerIndex"
                        },
                        "fromZone": "hand",
                        "toZone": "hand",
                        "filter": {
                          "type": "byRank",
                          "parameters": {
                            "rank": {
                              "reference": "action.rank"
                            }
                          }
                        }
                      }
                    },
                    {
                      "type": "checkSet",
                      "parameters": {
                        "playerIndex": {
                          "reference": "action.playerIndex"
                        }
                      }
                    },
                    {
                      "type": "setPhase",
                      "parameters": {
                        "phase": "askCard"
                      }
                    }
                  ],
                  "ifFalse": [
                    {
                      "type": "notification",
                      "parameters": {
                        "message": "Go Fish!"
                      }
                    },
                    {
                      "type": "drawCard",
                      "parameters": {
                        "playerIndex": {
                          "reference": "action.playerIndex"
                        },
                        "from": "deck",
                        "to": "hand",
                        "count": 1
                      }
                    },
                    {
                      "type": "conditional",
                      "parameters": {
                        "condition": {
                          "type": "drewRequestedRank",
                          "parameters": {
                            "rank": {
                              "reference": "action.rank"
                            }
                          }
                        },
                        "ifTrue": [
                          {
                            "type": "notification",
                            "parameters": {
                              "message": "Drew the requested card! Go again."
                            }
                          },
                          {
                            "type": "checkSet",
                            "parameters": {
                              "playerIndex": {
                                "reference": "action.playerIndex"
                              }
                            }
                          },
                          {
                            "type": "setPhase",
                            "parameters": {
                              "phase": "askCard"
                            }
                          }
                        ],
                        "ifFalse": [
                          {
                            "type": "setPhase",
                            "parameters": {
                              "phase": "end"
                            }
                          }
                        ]
                      }
                    }
                  ]
                }
              }
            ]
          }
        ],
        "skippable": false,
        "eachPlayer": true
      },
      {
        "id": "end",
        "displayName": "End of Turn",
        "automaticActions": [
          {
            "type": "endTurn",
            "effects": [
              {
                "type": "checkGameEnd",
                "parameters": {}
              }
            ]
          }
        ],
        "allowedActions": [],
        "skippable": true,
        "eachPlayer": false
      }
    ]
  },
  "setupRules": {
    "deckSetup": {
      "type": "standardDeck",
      "jokers": false
    },
    "initialHandSize": {
      "players2": 7,
      "players3": 7,
      "players4": 5,
      "players5": 5,
      "players6": 5
    }
  },
  "winConditions": [
    {
      "type": "deckEmpty",
      "parameters": {
        "andNoPlayableCards": true
      }
    }
  ],
  "scoringRules": {
    "type": "setCount",
    "parameters": {
      "scorePerSet": 1
    }
  },
  "customConditions": [
    {
      "id": "emptyHand",
      "description": "Checks if the active player's hand is empty"
    },
    {
      "id": "opponentHasRank",
      "description": "Checks if the target player has cards of the specified rank"
    },
    {
      "id": "drewRequestedRank",
      "description": "Checks if the player drew a card of the rank they requested"
    }
  ],
  "customEffects": [
    {
      "id": "checkSet",
      "description": "Checks if a player has completed a set (4 cards of the same rank)",
      "steps": [
        {
          "type": "checkCondition",
          "condition": {
            "type": "hasSet",
            "parameters": {}
          },
          "ifTrue": [
            {
              "type": "moveSet",
              "parameters": {
                "from": "hand",
                "to": "sets"
              }
            },
            {
              "type": "modifyResource",
              "parameters": {
                "resource": "score",
                "operation": "add",
                "value": 1
              }
            }
          ]
        }
      ]
    },
    {
      "id": "revealRank",
      "description": "Player reveals the rank they are asking for"
    },
    {
      "id": "transferCards",
      "description": "Transfers cards matching a filter from one player to another"
    }
  ]
}
